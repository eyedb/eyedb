eyedbexamplesdir=$(datadir)/doc/$(PACKAGE)/examples/C++Binding/schema-oriented/share
dist_eyedbexamples_DATA= schema.odl
nodist_eyedbexamples_DATA= init.sh
eyedbexamples_DATA=Makefile.eyedb-examples

check_LTLIBRARIES= libperson.la

nodist_libperson_la_SOURCES= person.cc personstubsbe.cc personstubsfe.cc

# The last directory is needed for endian.h, which is generated by configure.in
INCLUDES=-I$(top_srcdir)/src -I$(top_srcdir)/include -I$(top_builddir)/include

EYEDBODL_exe=$(top_builddir)/src/eyedb/eyedbodl
EYEDBODL = $(EYEDBODL_exe) --gencode=C++
EYEDBODLFLAGS= --package=person --schema-name=person

# Code snippet from autoconf documentation:
# http://www.gnu.org/software/autoconf/manual/autoconf.html#Installation-Directory-Variables
EDIT= sed \
        -e 's,@bindir[@],$(bindir),g' \
        -e 's,@exec_prefix[@],$(exec_prefix),g' \
        -e 's,@prefix[@],$(prefix),g' 

BUILT_SOURCES=personstubsbe.cc personstubsfe.cc

person.cc person.h personstubsbe.cc personstubsfe.cc: schema.odl
	-if test -x $(EYEDBODL_exe) ; then \
		echo $(EYEDBODL) $(EYEDBODLFLAGS) $< ; \
		$(EYEDBODL) $(EYEDBODLFLAGS) $< ; \
	else \
		echo Warning: $(EYEDBODL) not found ; \
	fi

clean-local:
	rm -f person.cc person.h personmthbe-skel.cc personmthfe-skel.cc personstubsbe.cc personstubsfe.cc 

%.sh: Makefile $(srcdir)/%.sh.in
	rm -f $@ $@.tmp
	$(EDIT) '$(srcdir)/$@.in' >$@.tmp
	mv $@.tmp $@

init:
	sh init.sh $(srcdir)/schema.odl
.PHONY: init

# Dependencies
person.$(OBJEXT): person.h

EXTRA_DIST=init.sh.in
